# IRR计算器

一个功能完整的内部收益率（IRR）计算工具，提供Python命令行版本和Web浏览器版本两种使用方式。

## 🌟 项目特点

- **双版本支持**：Python命令行版本 + HTML Web版本
- **完整数据显示**：显示所有年份数据，IRR为负数时智能隐藏
- **累计计算**：实时显示累计提取金额
- **精确计算**：IRR保留2位小数，基于二分法数值求解
- **Excel导出**：自动生成详细计算报告
- **现代化UI**：Web版本采用响应式设计，支持文件拖拽上传

## 📁 项目文件结构

```
IRR/
├── irr_calculator_final.py      # Python版本计算器
├── irr_calculator_final.html    # HTML版本计算器
├── 数据底稿.xlsx                # 示例数据文件
├── 使用说明.md                  # 详细使用说明
├── requirements.txt             # Python依赖包
└── README.md                    # 项目说明
```

## 🚀 快速开始

### Python版本

1. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **运行程序**
   ```bash
   python irr_calculator_final.py
   ```

### HTML版本

1. **直接使用**
   - 双击打开 `irr_calculator_final.html`
   - 或在浏览器中打开该文件

2. **在线演示**（如果部署到GitHub Pages）
   - 访问：`https://你的用户名.github.io/仓库名/irr_calculator_final.html`

## 💡 使用方法

### 数据准备
- 准备包含保费信息和提取数据的Excel文件
- 参考 `数据底稿.xlsx` 的格式

### 计算流程
1. **保费设置**：配置缴费年限、年缴金额等参数
2. **数据上传**：导入Excel数据文件
3. **结果查看**：查看IRR计算结果和图表分析
4. **报告导出**：下载Excel格式的详细报告

## 📊 计算逻辑

### 现金流构成
- **保费期**：第1-5年的保费支出（负现金流）
- **提取期**：第6年起的提取金额（正现金流）
- **终值期**：最终提取后的剩余价值

### IRR计算特点
- 基于完整现金流进行IRR计算
- 使用二分法进行数值求解
- 负数IRR显示为空，保持数据完整性
- 动态计算累计提取金额

## 📈 结果展示

### 输出格式
```
年份 | 提取金额(元) | 已提取金额累计(元) | 提取后总价值 | 现金流期数 | IRR%
-----------------------------------------------------------------
 2   |      0      |        0         |     640     |     6     |   -
 7   |   2,000     |     4,000        |   31,842    |     8     | 1.09%
10   |   2,000     |    10,000        |   33,857    |    11     | 3.56%
15   |   3,300     |    26,500        |   31,938    |    16     | 5.28%
```

### 关键指标
- **总数据行数**：显示所有年份的完整数据
- **有效IRR数量**：统计正数IRR的年份数量
- **关键年份汇总**：重点展示5、10、15、20、25年的IRR表现

## 🛠️ 技术实现

- **Python版本**：使用pandas进行数据处理，numpy支持数值计算
- **HTML版本**：原生JavaScript + Chart.js图表库
- **Excel处理**：支持openpyxl和xlsxwriter双引擎
- **IRR算法**：自实现二分法求解，精度可控

## 📋 系统要求

### Python版本
- Python 3.7+
- pandas >= 1.3.0
- numpy >= 1.21.0
- openpyxl >= 3.0.9

### HTML版本
- 现代Web浏览器（Chrome、Firefox、Safari、Edge）
- 支持JavaScript和FileReader API

## 🤝 贡献指南

欢迎提交Issue和Pull Request来改进项目！

## 📄 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 📞 联系方式

如有问题或建议，请通过GitHub Issues联系。

---

**版本**：最终版  
**更新时间**：2024年  
**主要功能**：IRR计算、数据分析、Excel报告生成 